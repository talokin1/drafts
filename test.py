MAP_MARKERS = {

    # 100 — Підприємства
    100: r"\b(підприємств|приватн.*підпр|державн.*підпр|комунальн.*підпр|казенн|дочірн|фермерськ|фг\b)\b",

    # 200 — Господарські товариства
    200: r"\b(товариств|тзов\b|тов\b|акціонерн|зао\b|оао\b|пат\b|повн.*товар|командит)\b",

    # 300 — Кооперативи
    300: r"\b(кооператив|кооп|виробнич.*кооп|обслуговуюч.*кооп|житлов.*кооп|гаражн.*кооп)\b",

    # 400 — Організації / установи / заклади
    400: r"\b(організаці|установа|заклад|державн.*орган|комунальн.*орган|приватн.*орган)\b",

    # 500 — Обʼєднання ЮО
    500: r"\b(об.?єднан|асоціац|корпорац|консорціум|концерн)\b",

    # 600 — Відокремлені підрозділи
    600: r"\b(філія|представницт|відокремлен.*підрозділ)\b",

    # 700 — Непідприємницькі
    700: r"\b(непідприємницьк)\b",

    # 800 — Громадські / профспілкові / релігійні
    800: r"\b(громадськ|профспілк|профсоюз|релігійн|церкв|благодійн|парті)\b",

    # 900 — Інші
    900: r"\b(інш.*організаційн.*форм)\b",
}

for code, pattern in MAP_MARKERS.items():
    if re.search(pattern, full_name_norm):
        name = opf_ref_top.loc[
            opf_ref_top["OPF_CODE_INT"] == code, "OPF_NAME"
        ].iloc[0]
        return code, name, "TOP_MARKER"






MAP_MARKERS_100 = {
    110: [  # Фермерське господарство
        r"\bфермерськ(е|ого)\s+господарств(о|а)\b",
        r"\bселянськ(е|ого)\s*\(фермерськ(е|ого)\)\s*господарств(о|а)\b",
        r"\bфг\b",
    ],

    120: [  # Приватне підприємство
        r"\bприватн(е|ого)\s+підприємств(о|а)\b",
        r"\bпп\b",
    ],

    130: [
        r"\bколективн(е|ого)\s+підприємств(о|а)\b",
    ],

    140: [
        r"\bдержавн(е|ого)\s+підприємств(о|а)\b",
        r"\bдп\b",
    ],

    145: [
        r"\bказенн(е|ого)\s+підприємств(о|а)\b",
    ],

    150: [
        r"\bкомунальн(е|ого)\s+підприємств(о|а)\b",
        r"\bкп\b",
    ],

    151: [
        r"\bспільн(е|ого)\s+комунальн(е|ого)\s+підприємств(о|а)\b",
    ],

    160: [
        r"\bдочірн(є|ого)\s+підприємств(о|а)\b",
    ],

    170: [
        r"\bіноземн(е|ого)\s+підприємств(о|а)\b",
    ],

    180: [
        r"\bпідприємств(о|а)\s+об.?єднанн(я|а)\s+громадян\b",
    ],

    185: [
        r"\bпідприємств(о|а)\s+споживч(ої|о)\s+коопераці(ї|і)\b",
    ],

    190: [
        r"\bорендн(е|ого)\s+підприємств(о|а)\b",
    ],

    191: [
        r"\bіндивідуальн(е|ого)\s+підприємств(о|а)\b",
    ],

    192: [
        r"\bсімейн(е|ого)\s+підприємств(о|а)\b",
    ],

    193: [
        r"\bспільн(е|ого)\s+підприємств(о|а)\b",
    ],

    100: [  # fallback
        r"\bпідприємств(о|а)\b",
        r"\bфірм(а|и)\b",
    ],
}


MAP_MARKERS_200 = {
    230: [
        r"\bакціонерн(е|ого)\s+товариств(о|а)\b",
        r"\bat\b",
    ],

    231: [
        r"\bвідкрит(е|ого)\s+акціонерн(е|ого)\s+товариств(о|а)\b",
        r"\bват\b",
    ],

    232: [
        r"\bзакрит(е|ого)\s+акціонерн(е|ого)\s+товариств(о|а)\b",
        r"\bзат\b",
    ],

    235: [
        r"\bдержавн(а|ої)\s+акціонерн(а|ої)\s+компані(я|ї)\b",
    ],

    236: [
        r"\bдержавн(а|ої)\s+холдингова\s+компані(я|ї)\b",
    ],

    237: [
        r"\bхолдингова\s+компані(я|ї)\b",
    ],

    240: [
        r"\bтовариств(о|а)\s+з\s+обмежен(ою|о)\s+відповідальніст(ю|і)\b",
        r"\bтов\b",
        r"\bтзов\b",
    ],

    250: [
        r"\bтовариств(о|а)\s+з\s+додатков(ою|о)\s+відповідальніст(ю|і)\b",
        r"\bтдв\b",
    ],

    260: [
        r"\bповн(е|ого)\s+товариств(о|а)\b",
    ],

    270: [
        r"\bкомандитн(е|ого)\s+товариств(о|а)\b",
    ],

    200: [
        r"\bгосподарськ(е|ого)\s+товариств(о|а)\b",
    ],
}

MAP_MARKERS_300 = {
    310: [r"\bвиробнич(ий|ого)\s+кооператив\b"],
    320: [r"\bобслуговуюч(ий|ого)\s+кооператив\b"],
    321: [r"\bжитлово-?будівельн(ий|ого)\s+кооператив\b", r"\bжбк\b"],
    322: [r"\bгаражн(ий|ого)\s+кооператив\b", r"\bгбк\b"],
    330: [r"\bспоживч(ий|ого)\s+кооператив\b"],
    331: [r"\bспоживч(е|ого)\s+товариств(о|а)\b"],
    340: [r"\bсільськогосподарськ(ий|ого)\s+виробнич(ий|ого)\s+кооператив\b"],
    350: [r"\bсільськогосподарськ(ий|ого)\s+обслуговуюч(ий|ого)\s+кооператив\b"],
    390: [r"\bкооперативн(ий|ого)\s+банк\b"],
    300: [r"\bкооператив\b"],
}

MAP_MARKERS_400 = {
    410: [r"\bорган\s+державно[їо]\s+влад[иі]\b"],
    415: [r"\bсуд\b"],
    420: [
        r"\b(міськ|сільськ|селищн)[ао]\s+рад[аи]\b",
        r"\bорган\s+місцевого\s+самоврядування\b",
    ],
    425: [r"\bдержавн(а|ої)\s+(установа|організаці[яї])\b"],
    430: [r"\bкомунальн(а|ої)\s+(установа|організаці[яї])\b"],
    435: [r"\bприватн(а|ої)\s+(установа|організаці[яї])\b"],
    440: [r"\bорганізаці[яї]\s+об.?єднанн(я|а)\s+громадян\b"],
    400: [r"\b(організаці[яї]|установа|заклад)\b"],
}

MAP_MARKERS_500 = {
    500: [r"\bоб.?єднанн(я|а)\s+підприємств\b"],
    510: [r"\bасоціаці(я|ї)\b"],
    520: [r"\bкорпораці(я|ї)\b"],
    530: [r"\bконсорціум\b"],
    540: [r"\bконцерн\b"],
    560: [r"\bспілк[аи]\s+споживчих\s+товариств\b"],
    590: [r"\bінші\s+об.?єднання\s+юридичних\s+осіб\b"],
}

MAP_MARKERS_600 = {
    600: [r"\bвідокремлен(ий|ого)\s+підрозділ\b"],
    610: [r"\bфілі(я|ї)\b"],
    620: [r"\bпредставництв(о|а)\b"],
}

MAP_MARKERS_700 = {
    700: [r"\bнепідприємницьк(е|ого)\s+підприємств(о|а)\b"],
    710: [r"\bорган(и|ів)?\s+адвокатськ(ого|ої)\s+самоврядування\b"],
    711: [r"\bорган(и|ів)?\s+суддівськ(ого|ої)\s+самоврядування\b"],
    712: [r"\bвищ(а|ої)\s+кваліфікаційн(а|ої)\s+комісі(я|ї)\s+суддів\b"],
    720: [r"\bфонд(и)?\s+соціального\s+страхування\b"],
}

MAP_MARKERS_750 = {
    750: [r"\bсаморегулівн(а|ої)\s+організаці(я|ї)\b"],
    760: [r"\bасоціаці(я|ї)\s+органів\s+місцевого\s+самоврядування\b"],
    770: [r"\bторгово-?промислов(а|ої)\s+палат(а|и)\b"],
    780: [r"\bаудиторськ(а|ої)\s+палат(а|и)\b"],
}

MAP_MARKERS_800 = {
    800: [r"\bгромадськ(е|ої)\s+об.?єднанн(я|а)\b"],
    810: [r"\bполітичн(а|ої)\s+парті(я|ї)\b"],
    815: [r"\bгромадськ(а|ої)\s+організаці(я|ї)\b"],
    820: [r"\bгромадськ(а|ої)\s+спілк(а|и)\b"],
    825: [r"\bрелігійн(а|ої)\s+організаці(я|ї)\b|\bцеркв"],
    830: [r"\bпрофспілк(а|и)\b|\bпервинн(а|ої)\s+профспілков"],
    835: [r"\bоб.?єднанн(я|а)\s+профспілок\b"],
    840: [r"\bтворч(а|ої)\s+спілк(а|и)\b"],
    845: [r"\bблагодійн(а|ої)\s+організаці(я|ї)\b|\bбф\b"],
    850: [r"\bорганізаці(я|ї)\s+роботодавц(ів|і)\b"],
    855: [r"\bоб.?єднанн(я|а)\s+співвласник(ів|и)\s+багатоквартирного\s+будинку\b|\bосбб\b"],
    860: [r"\bорган\s+самоорганізаці(ї|ї)\s+населенн(я|я)\b"],
}

MAP_MARKERS_900 = {
    900: [r"\bінші\s+організаційно-?правов(і|і)\s+форм(и|и)\b"],
    910: [r"\bпідприємець\b|\bфоп\b"],
    915: [r"\bтоварн(а|ої)\s+бірж(а|и)\b"],
    920: [r"\bфондов(а|ої)\s+бірж(а|и)\b"],
    925: [r"\bкредитн(а|ої)\s+спілк(а|и)\b"],
    940: [r"\bнедержавн(ий|ого)\s+пенсійний\s+фонд\b"],
    950: [r"\bсадівнич(е|ого)\s+товариств(о|а)\b"],
    995: [r"\bінші\s+організаційно-?правов(і|і)\s+форм(и|и)\b"],
}

